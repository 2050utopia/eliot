syntax = "proto3";
package cand.services.pods.v1;

option go_package = "pkg/api/services/pods/v1;pods";

// Pods provides visibility to the pods.
service Pods {
	rpc Create(CreatePodRequest) returns (CreatePodResponse);
	rpc List(ListPodsRequest) returns (ListPodsResponse);
	rpc Logs(GetLogsRequest) returns (stream GetLogsResponse);
}

message CreatePodRequest {
	Pod pod = 1;
}

message CreatePodResponse {
	Pod pod = 1;
}

message ListPodsRequest {
	string namespace = 1;
}

message ListPodsResponse {
	repeated Pod pods = 1;
}

message GetLogsRequest {
	string namespace = 1;
	string containerID = 2;
}

message GetLogsResponse {
	enum Type {
    STDOUT = 0;
    STDERR = 1;
	}
	Type type = 1;
	bytes line = 2;
}

message Pod {
	map<string, string> metadata = 1;
	PodSpec spec = 2;
	PodStatus status = 3;
}

message PodSpec {
	repeated Container containers = 1;
}

message Container {
	string ID = 1;
	string name = 2;
	string image = 3;
}

message PodStatus {
	repeated ContainerStatus containerStatuses = 1;
}

message ContainerStatus {
	string containerID = 1;
	string image = 2;
	string state = 3;
}